gcloud projects list

gcloud config set project misw-4301-native-cloud-433702 


docker build --platform linux/amd64 -t gcr.io/xenon-broker-309217/recomendations-command:latest .
docker push gcr.io/xenon-broker-309217/recomendations-command:latest
docker build --platform linux/amd64 -t gcr.io/xenon-broker-309217/recomendations-query:latest .
docker push gcr.io/xenon-broker-309217/recomendations-query:latest


kubectl apply -f recomendations-command-deployment.yaml
kubectl apply -f recomendations-command-service.yaml
kubectl apply -f recomendations-query-deployment.yaml
kubectl apply -f recomendations-query-service.yaml
kubectl apply -f recommendations-ingress.yaml




gcloud container clusters create my-cluster \
  --zone us-central1 \
  --num-nodes=1 \
  --machine-type=e2-standard-2 \
  --disk-size=10 \
  --enable-autoscaling --min-nodes=1 --max-nodes=3 \
  --enable-ip-alias \
  --scopes=https://www.googleapis.com/auth/cloud-platform

gcloud sql instances create write-instance \ 
--database-version=POSTGRES_13 \
  --tier=db-f1-micro \
  --region=us-central1

gcloud sql instances create read-instance \
  --database-version=POSTGRES_13 \
  --tier=db-f1-micro \
  --region=us-central1


  gcloud sql users create query_user \
    --instance=queries-db \
    --password="SECURE_PASSWORD_QUERY"


  gcloud sql databases create inventarios_db --instance=write-instance 


 gcloud functions deploy process_video \
  --runtime python39 \
  --trigger-resource videos_tiendas \
  --trigger-event google.storage.object.finalize \
  --entry-point process_video \
  --set-env-vars GCP_PROJECT=xenon-broker-309217,PUBSUB_TOPIC=video-procesado-topic \
  --project=xenon-broker-309217

gcloud functions list --project=xenon-broker-309217
gcloud functions logs read process_video --project=xenon-broker-309217


gcloud pubsub subscriptions create recommendations-pull-sub \                            
  --topic=video-procesado-topic \
  --project=xenon-broker-309217




gcloud compute instances describe gke-my-cluster-default-pool-ba89f0a0-3t0f \
  --zone us-central1-a \
  --format="value(serviceAccounts.email)"
  92636439949-compute@developer.gserviceaccount.com
  92636439949



docker build gcr.io/xenon-broker-309217/recomendations-command:latest .
docker push gcr.io/xenon-broker-309217/recomendations-command:latest



misw-4301-native-cloud-433702 


gcloud pubsub topics create compras-topic --project misw-4301-native-cloud-433702


gcloud pubsub subscriptions create inventarios-sub \
    --topic compras-topic \
    --project misw-4301-native-cloud-433702





docker build --platform linux/amd64 -t gcr.io/misw-4301-native-cloud-433702/ms_compras:latest .
docker push gcr.io/misw-4301-native-cloud-433702/ms_compras:latest

docker build --platform linux/amd64 -t gcr.io/misw-4301-native-cloud-433702/ms_inventarios:latest .
docker push gcr.io/misw-4301-native-cloud-433702/ms_inventarios:latest


kubectl apply -f ms-compras-deployment.yaml
kubectl apply -f ms-compras-service.yaml
kubectl apply -f ms-inventarios-deployment.yaml
kubectl apply -f ms-inventarios-service.yaml




kubectl logs ms-compras-deployment-9ffb5cdd-flkj9 --previous

gcloud pubsub subscriptions pull inventarios-sub --limit=10 --auto-ack --project misw-4301-native-cloud-433702

gcloud pubsub subscriptions describe inventarios-sub --project misw-4301-native-cloud-433702